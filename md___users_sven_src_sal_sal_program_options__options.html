<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sal: Options</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sal
   &#160;<span id="projectnumber">0.27.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md___users_sven_src_sal_sal_program_options__options.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Options </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sal_program_options_overview">Overview</a></li>
<li class="level1"><a href="#sal_program_options_usage">Usage</a><ul><li class="level2"><a href="#sal_program_options_help_screen">Help screen</a></li>
<li class="level2"><a href="#sal_program_options_help_screen_on_demand">Help screen on demand</a></li>
<li class="level2"><a href="#sal_program_options_combine">Combine command line and config file</a></li>
</ul>
</li>
<li class="level1"><a href="#sal_program_options_config">Config file format</a><ul><li class="level2"><a href="#sal_program_options_example">Example</a></li>
<li class="level2"><a href="#sal_program_options_spec">Spec</a></li>
<li class="level2"><a href="#sal_program_options_comment">Comment</a></li>
<li class="level2"><a href="#sal_program_options_key_value">Key/value pairs</a></li>
<li class="level2"><a href="#sal_program_options_string">String</a></li>
<li class="level2"><a href="#sal_program_options_object">Object</a></li>
<li class="level2"><a href="#sal_program_options_array">Array</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sal_program_options_overview"></a>
Overview</h1>
<p>Generic program options module. It offers classes to describe, parse and store options for programs. It allows to read options with their arguments from multiple sources and merge or look up individual values from option/argument map.</p>
<p>There are three major participants configuring program options:</p><ul>
<li><code><a class="el" href="classsal_1_1program__options_1_1option__set__t.html" title="Program options&#39; description. ">sal::program_options::option_set_t</a></code>: describes program options (i.e. whether argument is optional/required, help text etc). Once all options are described, it can generate full help page.</li>
<li><code><a class="el" href="classsal_1_1program__options_1_1argument__map__t.html" title="Program options&#39; arguments. ">sal::program_options::argument_map_t</a></code>: generic readonly map, storing program options and corresponding arugments.</li>
<li>parser: read and return option/argument pairs from specific source. SAL library has pre-defined parsers:<ul>
<li><code><a class="el" href="classsal_1_1program__options_1_1command__line__t.html" title="GNU-style command line options parser for option_set_t::load_from(). ">sal::program_options::command_line_t</a></code> for command line</li>
<li><code><a class="el" href="classsal_1_1program__options_1_1config__reader__t.html" title="Structured configuration file parser for option_set_t::load_from() ">sal::program_options::config_reader_t</a></code> for configuration file</li>
</ul>
</li>
</ul>
<p>All read options/arguments are stored in list. It is up to specific application to handle multiple values (i.e. merge, use first or let next to override previous etc).</p>
<h1><a class="anchor" id="sal_program_options_usage"></a>
Usage</h1>
<p>In following examples, it's assumed implicit <code>using namespace <a class="el" href="namespacesal_1_1program__options.html" title="Program options (command line, config file) ">sal::program_options</a>;</code></p>
<h2><a class="anchor" id="sal_program_options_help_screen"></a>
Help screen</h2>
<p>Create command line configuration that supports only <code>--help</code> and <code>--version</code> options and print help screen: </p><div class="fragment"><div class="line">option_set_t options;</div><div class="line">options</div><div class="line">  .add({<span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;help&quot;</span>},</div><div class="line">    <a class="code" href="namespacesal_1_1program__options.html#ac057132458b487d03dce66d068af93ce">help</a>(<span class="stringliteral">&quot;display this help and exit&quot;</span>)</div><div class="line">  )</div><div class="line">  .add({<span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;version&quot;</span>},</div><div class="line">    <a class="code" href="namespacesal_1_1program__options.html#ac057132458b487d03dce66d068af93ce">help</a>(<span class="stringliteral">&quot;output version information and exit&quot;</span>)</div><div class="line">  )</div><div class="line">;</div><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;usage:\n  &quot;</span></div><div class="line">  &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; [options]\n\n&quot;</span></div><div class="line">  &lt;&lt; options</div><div class="line">  &lt;&lt; std::endl</div><div class="line">;</div></div><!-- fragment --><h2><a class="anchor" id="sal_program_options_help_screen_on_demand"></a>
Help screen on demand</h2>
<p>This example uses <code>options</code> from previous example and parses command line from specified <code>argc</code>/<code>argv</code>. If user has passed either <code>-h</code> or <code>--help</code>, print help screen: </p><div class="fragment"><div class="line"><span class="comment">// parse command line interface</span></div><div class="line"><span class="keyword">auto</span> cli = options.parse&lt;command_line_t&gt;(argc, argv);</div><div class="line"><span class="keywordflow">if</span> (cli.has(<span class="stringliteral">&quot;help&quot;</span>))</div><div class="line">{</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;usage:\n  &quot;</span></div><div class="line">    &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; [options]\n\n&quot;</span></div><div class="line">    &lt;&lt; <span class="stringliteral">&quot;options:&quot;</span></div><div class="line">    &lt;&lt; options</div><div class="line">    &lt;&lt; std::endl</div><div class="line">  ;</div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><p> Note how code checks for <code>"help"</code> only and it works if either <code>-h</code> or <code>--help</code> is used.</p>
<h2><a class="anchor" id="sal_program_options_combine"></a>
Combine command line and config file</h2>
<p>Following examples that allows to specify input file, either on command line or from configuration file. Confguration file name itself can be given on command line:</p>
<p>First, create options description set: </p><div class="fragment"><div class="line">option_set_t options;</div><div class="line">options</div><div class="line">  .add({<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;config&quot;</span>}, <a class="code" href="namespacesal_1_1program__options.html#ac057132458b487d03dce66d068af93ce">help</a>(<span class="stringliteral">&quot;config file&quot;</span>),</div><div class="line">    <a class="code" href="namespacesal_1_1program__options.html#add4852e6aca54ba4ec3820359d4ad35e">requires_argument</a>(<span class="stringliteral">&quot;FILE&quot;</span>, <span class="stringliteral">&quot;my-app.conf&quot;</span>)</div><div class="line">  )</div><div class="line">  .add({<span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;file&quot;</span>}, <a class="code" href="namespacesal_1_1program__options.html#ac057132458b487d03dce66d068af93ce">help</a>(<span class="stringliteral">&quot;input file&quot;</span>),</div><div class="line">    <a class="code" href="namespacesal_1_1program__options.html#add4852e6aca54ba4ec3820359d4ad35e">requires_argument</a>(<span class="stringliteral">&quot;FILE&quot;</span>)</div><div class="line">  )</div><div class="line">;</div></div><!-- fragment --><p> It allows to pass config file name to load (using <code>-c</code> or <code>--config</code>). If none it given, <code>my-app.conf</code> is used as default.</p>
<p>Next, parse command line to get configuration file to load (in case there are multiple config files listed, use only last): </p><div class="fragment"><div class="line"><span class="keyword">auto</span> cli = options.parse&lt;command_line_t&gt;(argc, argv);</div><div class="line"><span class="keyword">auto</span> config_file_name = options.back_or_default(<span class="stringliteral">&quot;config&quot;</span>, { cli });</div></div><!-- fragment --><p>Read and parse configuration file (file open error handling is skipped for clarity): </p><div class="fragment"><div class="line">std::ifstream config_file{config_file_name};</div><div class="line"><span class="keyword">auto</span> config = options.parse&lt;config_reader_t&gt;(config_file);</div></div><!-- fragment --><p>Following examples show different ways to combine values from command line and/or configuration file.</p>
<h3>Use all given file names</h3>
<p>Iterate over all files give both command line or configuration file: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;file_name: options.merge(<span class="stringliteral">&quot;file&quot;</span>, { cli, config }))</div><div class="line">{</div><div class="line">  std::cout &lt;&lt; file_name &lt;&lt; std::endl;</div><div class="line">}</div></div><!-- fragment --><h3>Use first occurrence, prefer command line over configuration file</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> &amp;<a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> = options.front_or_default(<span class="stringliteral">&quot;file&quot;</span>, { cli, config });</div><div class="line">std::cout &lt;&lt; <a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> &lt;&lt; std::endl;</div></div><!-- fragment --><h3>Use first occurrence, prefer configuration file over command line</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> &amp;<a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> = options.front_or_default(<span class="stringliteral">&quot;file&quot;</span>, { config, cli });</div><div class="line">std::cout &lt;&lt; <a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> &lt;&lt; std::endl;</div></div><!-- fragment --><h3>Use last occurrence, prefer command line over configuration file</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> &amp;<a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> = options.back_or_default(<span class="stringliteral">&quot;file&quot;</span>, { config, cli });</div><div class="line">std::cout &lt;&lt; <a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> &lt;&lt; std::endl;</div></div><!-- fragment --><h3>Use last occurrence, prefer configuration file over command line</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> &amp;<a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> = options.back_or_default(<span class="stringliteral">&quot;file&quot;</span>, { cli, config });</div><div class="line">std::cout &lt;&lt; <a class="code" href="namespacesal_1_1logger.html#a65e70bb595b86a2ebaa666afa413342b">file</a> &lt;&lt; std::endl;</div></div><!-- fragment --><h1><a class="anchor" id="sal_program_options_config"></a>
Config file format</h1>
<p>Different syntaxes used to mix SAL configuration file format:</p><ul>
<li>JSON <a href="http://json.org">http://json.org</a></li>
<li>HJSON <a href="http://hjson.org/syntax.html">http://hjson.org/syntax.html</a></li>
<li>SJSON <a href="http://help.autodesk.com/cloudhelp/ENU/Stingray-Help/stingray_help/managing_content/sjson.html">http://help.autodesk.com/cloudhelp/ENU/Stingray-Help/stingray_help/managing_content/sjson.html</a></li>
<li>TOML <a href="https://github.com/toml-lang/toml">https://github.com/toml-lang/toml</a></li>
</ul>
<p>Note: although SAL config file format parser can parse JSON input, it does not support arrays that contain other arrays or objects.</p>
<h2><a class="anchor" id="sal_program_options_example"></a>
Example</h2>
<div class="fragment"><div class="line">/**</div><div class="line"> * You can use block comments</div><div class="line"> * /* that can be even recursive */</div><div class="line"> */</div><div class="line"></div><div class="line">one = 1 two = 2 // comment that lasts until newline</div><div class="line"></div><div class="line">&quot;assignment that continues&quot;</div><div class="line">  =</div><div class="line">  &quot;on next line&quot;, another = value</div><div class="line"></div><div class="line">nested = {</div><div class="line">  trailing: with_comma,         // nested.trailing = with_comma</div><div class="line">  key = value                   // nested.key = value</div><div class="line">  deeper = { key = value }      // nested.deeper.key = value</div><div class="line">}</div><div class="line"></div><div class="line">// multiline string</div><div class="line">text = &#39;&#39;&#39;</div><div class="line">  can use</div><div class="line">    text</div><div class="line">  that preserves indentation</div><div class="line">&#39;&#39;&#39;</div><div class="line"></div><div class="line">&#39;list of values&#39; = [</div><div class="line"> one,</div><div class="line"> two,</div><div class="line"> three,</div><div class="line">]</div></div><!-- fragment --><h2><a class="anchor" id="sal_program_options_spec"></a>
Spec</h2>
<ul>
<li>Case sensitive</li>
<li>UTF-8 only</li>
<li>Whitespace is defined as <code>std::isspace()</code></li>
<li>Newline is either <code>\n</code> or <code>\r\n</code></li>
</ul>
<h2><a class="anchor" id="sal_program_options_comment"></a>
Comment</h2>
<p>C++ style comments:</p><ul>
<li>Line comment marked with <code>//</code>: everything is ignored until newline</li>
<li>Block comment is between <code>/*</code> and <code>*/</code>. Block comment inside other block comment are allowed. Block ends until it's beginnings and endings are equally paired.</li>
</ul>
<h2><a class="anchor" id="sal_program_options_key_value"></a>
Key/value pairs</h2>
<p>Both colon <code>:</code> and assignment <code>=</code> can be used to create key/value pairs and they can be freely placed (even on separate lines or on same line). Also, consecutive pairs can be separated with commas but don't have to: </p><div class="fragment"><div class="line">one = 1</div><div class="line">two: 2</div><div class="line">three</div><div class="line"> = 3, four = 4 five : 5</div></div><!-- fragment --><p>Keys can be bare or quoted:</p><ul>
<li>bare key names may contain letters, numbers, underscores and dashes</li>
<li>quoted keys follow same rules as basic or literal strings (described below)</li>
</ul>
<div class="fragment"><div class="line">key = value</div><div class="line">bare-key = value</div><div class="line">bare_key = value</div><div class="line">123 = value</div><div class="line"></div><div class="line">&quot;key with spaces&quot; = value</div><div class="line">&#39;&#39; = value // key with no name</div></div><!-- fragment --><h2><a class="anchor" id="sal_program_options_string"></a>
String</h2>
<p>There are multiple string types:</p><ul>
<li>basic string (marked with double quote <code>"</code>)</li>
<li>literal string (marked with single quote &lsquo;&rsquo;<code>)</code></li>
<li><code>basic multiline string (marked with triple double quotes</code>"<code>)</code></li>
<li><code>literal multiline string (marked with triple single quotes</code>'`)</li>
<li>quoteless string</li>
</ul>
<p>In case of basic strings it can contain escaped characters that will be unescaped:</p><ul>
<li><code>\b</code> backspace (8)</li>
<li><code>\t</code> tab (9)</li>
<li><code>\n</code> linefeed (10))</li>
<li><code>\f</code> formfeed (12)</li>
<li><code>\r</code> carriage return (13)</li>
<li><code>\"</code> double quote (34)</li>
<li><code>\\</code> backslash (92)</li>
</ul>
<p>All other escapes will produce error. In literal strings, no such unescaping is done.</p>
<p>Multiline variants of those strings can span over multiple lines and whitespaces are preserved in returned values. Only newline immediately following opening delimiters will be trimmed.</p>
<p>Quoteless strings can contain any characters and continue until comma or whitespace.</p>
<div class="fragment"><div class="line">//</div><div class="line">key = &quot;continuing\non\nnext line&quot;</div><div class="line">regex = &#39;\s+&#39;</div><div class="line">quoteless = \s+</div><div class="line"></div><div class="line">// &quot;text\n on\nmultiple lines\n&quot;</div><div class="line">key = &quot;&quot;&quot;</div><div class="line">text</div><div class="line"> on</div><div class="line">multiple lines</div><div class="line">&quot;&quot;&quot;</div></div><!-- fragment --><h2><a class="anchor" id="sal_program_options_object"></a>
Object</h2>
<p>Object is structured list of key/value pairs that begins and ends with curly braces (begin with <code>{</code> and end with <code>}</code>). Objects can contain also nested objects. Also, whole document can be nested inside object.</p>
<div class="fragment"><div class="line">{</div><div class="line">  nested = {</div><div class="line">    deeper = {</div><div class="line">      key = 1</div><div class="line">      array = [ one, two ]</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="sal_program_options_array"></a>
Array</h2>
<p>Arrays are delimited with square brackets with values inside (or can be empty). Whitespaces between values are ignored. Elements can be separated with comma but don't have to. Final element can have also trailing comma.</p>
<p>Array elements can't be another arrays or objects.</p>
<div class="fragment"><div class="line">empty-array = []</div><div class="line">array-with-commas = [ 1, 2, ]</div><div class="line">array-with-whitespaces = [ 1 2</div><div class="line"> 3</div><div class="line"> 4</div><div class="line">]</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
